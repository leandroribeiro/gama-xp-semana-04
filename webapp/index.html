<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <!--
https://greensock.com/forums/topic/9059-cross-browser-to-detect-tab-or-window-is-active-so-animations-stay-in-sync-using-html5-visibility-api/

 -->

    <iframe width="560" height="315" src="https://www.youtube.com/embed/ycPIaaKCyDQ" frameborder="0" allowfullscreen></iframe>

    <h3>Tempo de Transmissão : <span id="tempoDeTransmissao"></span></h3>
    <h3>Tempo Ativo na Transmissão : <span id="tempoAtivoDeTransmissão"></span></h3>

    <h3>Saiu : <span id="quantidadeVezesSaiu"></span></h3>
    <h3>Entrou : <span id="quantidadeVezesEntrou"></span></h3>


    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

    <script type="text/javascript">

    var tempo = new Number();

    // Tempo em segundos
    tempo = 0;

    function startCountdown(){

    		// Pega a parte inteira dos minutos
    		var min = parseInt(tempo/60);
    		// Calcula os segundos restantes
    		var seg = tempo%60;

    		// Formata o número menor que dez, ex: 08, 07, ...
    		if(min < 10){
    			min = "0"+min;
    			min = min.substr(0, 2);
    		}
    		if(seg <=9){
    			seg = "0"+seg;
    		}

    		// Cria a variável para formatar no estilo hora/cronômetro
    		horaImprimivel = '00:' + min + ':' + seg;
    		//JQuery pra setar o valor
    		$("#tempoDeTransmissao").html(horaImprimivel);

    		// Define que a função será executada novamente em 1000ms = 1 segundo
    		setTimeout('startCountdown()',1000);

    		// diminui o tempo
    		tempo++;
    }

    // Chama a função ao carregar a tela
    startCountdown();

    </script>

    <script type="text/javascript">
        var saiu = 0;
        var entrou = 0;

        //https://greensock.com/forums/topic/9059-cross-browser-to-detect-tab-or-window-is-active-so-animations-stay-in-sync-using-html5-visibility-api/

        // check if browser window has focus
        var notIE = (document.documentMode === undefined),
            isChromium = window.chrome;

        if (notIE && !isChromium) {

            // checks for Firefox and other  NON IE Chrome versions
            $(window).on("focusin", function() {

                // tween resume() code goes here
                setTimeout(function() {
                    atualizaEstatisticaDeEntrou();
                }, 300);

            }).on("focusout", function() {

                atualizaEstatisticaDeSaiu();

            });

        } else {

            // checks for IE and Chromium versions
            if (window.addEventListener) {

                // bind focus event
                window.addEventListener("focus", function(event) {

                    // tween resume() code goes here
                    setTimeout(function() {
                        atualizaEstatisticaDeEntrou();
                    }, 300);

                }, false);

                // bind blur event
                window.addEventListener("blur", function(event) {

                    atualizaEstatisticaDeSaiu();

                }, false);

            } else {

                // bind focus event
                window.attachEvent("focus", function(event) {

                    // tween resume() code goes here
                    setTimeout(function() {
                        atualizaEstatisticaDeEntrou();
                    }, 300);

                });

                // bind focus event
                window.attachEvent("blur", function(event) {
                    atualizaEstatisticaDeSaiu();
                });
            }
        }

        function atualizaEstatisticaDeSaiu() {
            saiu += 1;
            $("#quantidadeVezesSaiu").text(saiu);
        }

        function atualizaEstatisticaDeEntrou() {
            entrou += 1;
            $("#quantidadeVezesEntrou").text(saiu);
        }
    </script>


</body>

</html>
